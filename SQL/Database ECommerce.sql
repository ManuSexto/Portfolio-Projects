

USE AdventureWorks2017;

/*
 DROP TABLE EC_Territorio;
 DROP TABLE EC_Clientes;
 DROP TABLE EC_Clientes_IN;
 DROP TABLE EC_Clientes_EM;
 DROP TABLE EC_Productos;
 DROP TABLE EC_Cat_Productos;
 DROP TABLE EC_Facturas;
 DROP TABLE EC_Transacciones;
 */

CREATE TABLE EC_Territorio (
	TerritorioID INT,
	Pais VARCHAR(50),
	CodigoPais VARCHAR(5),
	Region VARCHAR(100),
	Grupo VARCHAR(10)
							);

INSERT INTO EC_Territorio (TerritorioID, Pais, CodigoPais, Region, Grupo)
VALUES (1,	'Espana',	'ES',	'Europa',	'EU'),
(2,	'Portugal'	,'PO',	'Europa',	'EU'),
(3,	'Alemania',	'AL',	'Europa',	'EU'),
(4,	'Inglaterra',	'IN',	'Europa',	'EU'),
(5,	'EEUU'	,'NA'	,'América',	'AM'),
(6,	'Rusia'	,'RU',	'Europa Oriental',	'EUO'),
(7,	'Japon',	'JA',	'Asia',	'AS');


CREATE TABLE EC_Clientes (
		IDCliente INT,
		TerritorioID INT,
		NumeroCuenta VARCHAR(100),
		FechaAlta DATETIME,
		Fecha_Actualizacion DATETIME
				);
				
INSERT INTO EC_Clientes (IDCliente, TerritorioID, NumeroCuenta, FechaAlta, Fecha_Actualizacion)
VALUES (45567,2,'124574584568','20140112','20180524'),
(45568,4,'753464484125','20170927','20180524'),
(45569,6,'220344846854','20180128','20180524'),
(45570,4,'146345286589','20150610',NULL),
(45571,7,'321436588521','20120122',NULL),
(45572,3,'951435789654','20120226','20180708'),
(45573,5,'159735465236','20110812','20180708'),
(45574,4,'745630214565','20111026','20180822'),
(45575,2,'943734703258','20131109',NULL),
(45576,1,'126778324298','20160312','20181002'),
(45577,5,'365814520232','20170126','20181002'),
(45578,1,'111533697456','20171225','20181112'),
(45579,1,'252236589632','20171108',NULL),
(45580,4,'484114694631','20171122',NULL),
(45581,3,'132446156431','20180113',NULL),
(45582,5,'123474569654','20180319',NULL);

CREATE TABLE EC_Clientes_IN (
		IDClienteIN INT,
		IDCliente INT,
		Nombre VARCHAR(100),
		Apellidos VARCHAR(100),
		Fecha_Nacimiento DATETIME,
		Pasaporte VARCHAR(100),
		Ocupacion VARCHAR(100),
		Genero VARCHAR(100),
		Fecha_Primera_Compra DATETIME,
		Telefono INT
						);

INSERT INTO EC_Clientes_IN (IDClienteIN, IDCliente, Nombre, Apellidos, Fecha_Nacimiento, Pasaporte, Ocupacion, Genero, Fecha_Primera_Compra, Telefono)
VALUES (45,45567,'Sharon','Anderson','19771127',55557132036181,'Analista','M','20140113',6458978),
(46,45569,'John','Johnson','19731213',77778344838353,'Investigador','H','20180128',6459302),
(47,45571,'Jill','Ellerbrock','19710906',55557132036181,'Empresario','M','20120124',6529156),
(48,45573,'Wanida','Glimp','19421223',33335352517363,'Gerente','M','20110813',6564909),
(49,45576,'Mark','Maxwell','19770121',11119775847802,'Analista','H','20160312',6564557),
(50,45578,'Margie','Tibbott','19570619',55553465625901,'Profesor','M','20171231',7527771);


CREATE TABLE EC_Clientes_EM (
		IDClienteEM INT,
		IDCliente INT,
		DenominacionSocial  VARCHAR(100),
		Tipo VARCHAR(100),
		Fundacion INT,
		Fecha_Primera_Compra DATETIME,
		Telefono INT
						);

INSERT INTO EC_Clientes_EM (IDClienteEM, IDCliente, DenominacionSocial, Tipo, Fundacion, Fecha_Primera_Compra, Telefono)
VALUES (1475,45568,'FORISA','PYME',2010,'20170927',6460223),
(1476,45570,'PRODCUTA','Corporacion',1994,'20150610',6460547),
(1477,45572,'MMN43','PYME',2011,'20120226',6530401),
(1478,45574,'GroveStreet','PYME',2013,'20111026',6566154),
(1479,45575,'Vespuchi','Corporacion',1996,'20131109',6565802),
(1480,45577,'Andor','PYME',2014,'20170126',7529016),
(1481,45579,'Tatooine','PYME',2009,'20171108',6444457);


CREATE TABLE EC_Productos (
		IDProducto INT,
		Nombre  VARCHAR(100),
		NumeroProducto VARCHAR(10),
		Color VARCHAR(10),
		Precio NUMERIC(38,4),
		Peso_gramos INT,
		Talla_disponibles VARCHAR(50),
		GrupoProductoID INT
						);

INSERT INTO EC_Productos (IDProducto, Nombre, NumeroProducto, Color, Precio, Peso_gramos, Talla_disponibles, GrupoProductoID) 
VALUES (145,'Camiseta Verde','CA','VERDE',15.95,100,'S-XL',10),
(146,'Camiseta Roja','CR','ROJO',15.95,100,'S-XL',10),
(147,'Camiseta Marron','CM','MARRON',15.95,100,'S-XL',10),
(148,'Camiseta Gris','CG','GRIS',15.95,100,'S-XL',10),
(149,'Camiseta Verde','CV','VERDE',15.95,100,'S-XL',10),
(150,'Pack 3 Camisetas','P3C',NULL,37.5,320,'S-XL',10),
(151,'Pack 5 Camisetas','P5C',NULL,55.25,430,'S-XL',10),
(152,'Polo Azul','PA','AZUL',27.95,120,'XS-XL',12),
(153,'Polo Gris','PG','GRIS',27.95,120,'XS-XL',12),
(154,'Polo Negro','PN','NEGRO',27.95,120,'XS-XL',12),
(155,'Pack 3 Polos','P3P',NULL,49.99,400,'XS-XL',12),
(156,'Camisa basica','CB',NULL,30.25,130,'XS-XXL',11),
(157,'Camisa Seda Azul','CSA','AZUL',50.99,130,'XS-XXL',11),
(158,'Camisa Seda Negra','CSN','NEGRO',50.99,130,'XS-XXL',11),
(159,'Camisa Seda Blanca','CSB','BLANCO',50.99,130,'XS-XXL',11),
(160,'Pack 2 Camisas Traje','P2CT','NULL',85.95,290,'XS-XXL',11),
(161,'Pantalon Chino Beige','PCB','BEIGE',37.95,240,'36-56',13),
(162,'Pantalon Chino Azul Marino','PCAM','AZUL',37.95,240,'36-56',13),
(163,'Pantalon Chino Negro','PCN','NEGRO',37.95,240,'36-56',13),
(164,'Vaquero Regular Azul','VAR','AZUL',44.5,470,'36-56',14),
(165,'Vaquero Regular Desgastado','VRD','NULL',44.5,470,'36-56',14),
(166,'Vaquero Slim Azul','VSA','AZUL',60.95,470,'36-56',14),
(167,'Vaquero Skinny Negro','VSN','NEGRO',60.95,470,'36-56',14),
(168,'Zapatillas Futbol','ZF',NULL,120.95,370,'39-46',15),
(169,'Zapatillas Baloncesto','ZB',NULL,115.5,400,'39-46',15),
(170,'Zapatillas Running','ZR',NULL,175.95,295,'39-46',15),
(171,'Zapatillas Trail','ZT',NULL,145.5,320,'39-46',15),
(172,'Bota alta impermeable','BAI','NEGRO',78.95,600,'36-46',16),
(173,'Bota media','BM','MARRON',55.95,552,'36-46',16),
(174,'Bota alta ','BA','MARRON',65.95,600,'36-46',16),
(175,'Bota impermeable ','BI','NEGRO',75.95,600,'36-56',16),
(176,'Bota de moto','BM','MARRON',115.95,1000,'36-46',16);


CREATE TABLE EC_Cat_Productos(
		GrupoProductoID INT,
		Nombre VARCHAR(50),
		EnglishName VARCHAR(50)
						);

INSERT INTO EC_Cat_Productos (GrupoProductoID, Nombre, EnglishName)
VALUES (10,	'Camiseta',	'T-Shirt'),
(11,	'Camisa',	'Shirt'),
(12,	'Polo',	'Polo'),
(13,	'Pantalon Chino',	'Pants'),
(14,	'Vaquero',	'Jeans'),
(15,	'Zapatilla',	'Sneakers'),
(16,	'Bota',	'Boots');

CREATE TABLE EC_Facturas(
		IDFactura INT,
		FechaPedido DATETIME,
		FechaEnvio DATETIME,
		EstadoPedido VARCHAR(50),
		IDCliente INT,
		Total DECIMAL(38,4),
		Impuestos DECIMAL(38,4),
		Total_con_Impuestos DECIMAL(38,4),
		Observaciones VARCHAR(255)
						);

INSERT INTO EC_Facturas (IDFactura, FechaPedido, FechaEnvio, EstadoPedido, IDCliente, Total, Impuestos, Total_con_Impuestos, Observaciones )
VALUES (987456,'20190315','20190320','Enviado',45567,4473.3781,939.409401,5412.787501,'Entrega con preaviso'),
(987457,'20190315','20190321','Enviado',45570,5781.8225,1214.182725,6996.005225,'Llamar antes de la entrega'),
(987458,'20190315','20190323','Enviado',45574,3852.5375,809.032875,4661.570375,'Entrega urgente'),
(987459,'20190315','20190321','Enviado',45577,454.58,95.4618,550.0418,'Incidencia 4568'),
(987460,'20190402',NULL,'Cancelado',45580,433.65,91.0665,524.7165,'Incidencia 9658'),
(987461,'20190402','20190409','Enviado',45581,648.2275,136.127775,784.355275,'Incidencia 1234'),
(987462,'20190402','20190411','Enviado',45568,1289.2925,270.751425,1560.043925,NULL),
(987463,'20190402','20190416','Enviado',45569,1060.0875,222.618375,1282.705875,'Incidencia 9658'),
(987464,'20190402',NULL,'Cancelado',45572,1404.936,295.03656,1699.97256,'Incidencia 1234'),
(987465,'20190402','20190420','Enviado',45576,1939.4685,407.288385,2346.756885,'Llamar antes de la entrega'),
(987466,'20190507','20190515','Enviado',45579,2212.656,464.65776,2677.31376,NULL),
(987467,'20190507','20190526','Enviado',45568,0,0,0,'Incidencia 9658'),
(987468,'20190507',NULL,'Cancelado',45569,0,0,0,'Incidencia 4568'),
(987469,'20190507','20190525','Enviado',45570,590.04,123.9084,713.9484,'Incidencia 4568'),
(987470,'20190507','20190511','Enviado',45571,1286.2145,270.105045,1556.319545,'Llamar antes de la entrega'),
(987471,'20190507','20190521','Enviado',45572,560.88,117.7848,678.6648,NULL),
(987472,'20190507',NULL,'Cancelado',45573,1540.765,323.56065,1864.32565,'Entrega con preaviso'),
(987473,'20190731',NULL,'Cancelado',45574,1244.025,261.24525,1505.27025,NULL),
(987474,'20190731','20190815','Enviado',45575,449.958,94.49118,544.44918,'Entrega con preaviso'),
(987475,'20190731','20190904','Enviado',45576,621.5225,130.519725,752.042225,'Llamar antes de la entrega'),
(987476,'20190731',NULL,'Cancelado',45577,1169.3445,245.562345,1414.906845,NULL),
(987477,'20190731','20190815','Enviado',45578,524.565,110.15865,634.72365,'Incidencia 4568'),
(987478,'20190731','20190806','Enviado',45579,830.807,174.46947,1005.27647,NULL),
(987479,'20190731','20190922','Enviado',45580,309.4675,64.988175,374.455675,'Llamar antes de la entrega'),
(987480,'20190914','20190923','Enviado',45581,687.1351,144.298371,831.433471,'Incidencia 9658'),
(987481,'20190914',NULL,'Cancelado',45582,453.56,95.2476,548.8076,'Entrega con preaviso'),
(987482,'20190914','20190918','Enviado',45567,533.5375,112.042875,645.580375,'Entrega con preaviso'),
(987483,'20190914',NULL,'Cancelado',45568,1047.5949,219.994929,1267.589829,'Incidencia 1234'),
(987484,'20191019','20190929','Enviado',45570,1290.555,271.01655,1561.57155,'Entrega con preaviso'),
(987485,'20191019',NULL,'Cancelado',45572,792.6535,166.457235,959.110735,'Llamar antes de la entrega'),
(987486,'20191019','20191107','Enviado',45574,613.333,128.79993,742.13293,NULL),
(987487,'20191221','20200111','Enviado',45575,650.797,136.66737,787.46437,'Incidencia 4568'),
(987488,'20191221',NULL,'Cancelado',45577,1066.5885,223.983585,1290.572085,'Incidencia 4568'),
(987489,'20191221',NULL,'Cancelado',45578,509.4345,106.981245,616.415745,'Incidencia 9658'),
(987490,'20191221','20200228','Enviado',45579,470.3855,98.780955,569.166455,'Llamar antes de la entrega'),
(987491,'20191221',NULL,'Cancelado',45580,1224.2525,257.093025,1481.345525,'Incidencia 1234'),
(987492,'20191221','20200302','Enviado',45581,0,0,0,'Entrega con preaviso'),
(987493,'20191221','20200226','Enviado',45582,1004.483,210.94143,1215.42443,'Llamar antes de la entrega'),
(987494,'20200327',NULL,'Cancelado',45569,764.728,160.59288,925.32088,NULL),
(987495,'20200327','20200405','Enviado',45571,711.5745,149.430645,861.005145,'Llamar antes de la entrega'),
(987496,'20200327','20200402','Enviado',45573,1121.7,235.557,1357.257,'Entrega con preaviso');


CREATE TABLE EC_Transacciones(
		IDTransaccion INT,
		IDFactura INT,
		IDProducto INT,
		Cantidad INT,
		Descuento DECIMAL(38,2),
		PrecioLinea  DECIMAL(38,4)
						);

INSERT INTO EC_Transacciones (IDTransaccion, IDFactura, IDProducto, Cantidad, Descuento, PrecioLinea)
VALUES (145278514,987456,164,5,0.05,211.375),
(145278515,987456,151,9,0.08,457.47),
(145278516,987456,150,9,0.08,310.5),
(145278517,987456,148,9,0.08,132.066),
(145278518,987456,149,9,0.08,132.066),
(145278519,987456,157,8,0.07,379.3656),
(145278520,987456,153,8,0.07,207.948),
(145278521,987456,148,8,0.07,118.668),
(145278522,987456,174,7,0.07,429.3345),
(145278523,987456,173,7,0.07,364.2345),
(145278524,987456,150,7,0.07,244.125),
(145278525,987456,162,7,0.07,247.0545),
(145278526,987456,168,6,0.05,689.415),
(145278527,987456,159,6,0.05,290.643),
(145278528,987456,172,6,0.05,450.015),
(145278529,987456,174,6,0.05,375.915),
(145278530,987456,147,6,0.05,90.915),
(145278531,987456,150,4,0,150),
(145278532,987457,160,9,0.08,711.666),
(145278533,987457,162,9,0.08,314.226),
(145278534,987457,163,9,0.08,314.226),
(145278535,987457,164,6,0.05,253.65),
(145278536,987457,170,5,0.05,835.7625),
(145278537,987457,169,5,0.05,548.625),
(145278538,987457,160,5,0.05,408.2625),
(145278539,987457,155,5,0.05,237.4525),
(145278540,987457,155,5,0.05,237.4525),
(145278541,987457,161,5,0.05,180.2625),
(145278542,987457,167,5,0.05,289.5125),
(145278543,987457,152,5,0.05,132.7625),
(145278544,987457,170,4,0,703.8),
(145278545,987457,168,4,0,483.8),
(145278546,987457,166,4,0,243.8),
(145278547,987457,160,4,0,343.8),
(145278548,987457,174,4,0,263.8),
(145278549,987457,165,4,0,178),
(145278550,987457,153,4,0,111.8),
(145278551,987457,163,1,0,37.95),
(145278552,987458,170,9,0.08,1456.866),
(145278553,987458,169,9,0.08,956.34),
(145278554,987458,169,9,0.08,956.34),
(145278555,987458,164,9,0.08,368.46),
(145278556,987458,169,7,0.07,751.905),
(145278557,987458,169,6,0.05,658.35),
(145278558,987458,163,5,0.05,180.2625),
(145278559,987458,172,4,0,315.8),
(145278560,987458,159,4,0,203.96),
(145278561,987458,161,4,0,151.8),
(145278562,987458,154,4,0,111.8),
(145278563,987458,149,4,0,63.8),
(145278564,987458,171,3,0,436.5),
(145278565,987458,151,3,0,165.75),
(145278566,987459,166,3,0,182.85),
(145278567,987459,147,3,0,47.85),
(145278568,987459,167,2,0,121.9),
(145278569,987459,158,2,0,101.98),
(145278570,987460,168,2,0,241.9),
(145278571,987460,174,2,0,131.9),
(145278572,987460,146,2,0,31.9),
(145278573,987460,153,1,0,27.95),
(145278574,987461,157,5,0.05,242.2025),
(145278575,987461,161,5,0.05,180.2625),
(145278576,987461,146,5,0.05,75.7625),
(145278577,987461,150,4,0,150),
(145278578,987462,154,6,0.05,159.315),
(145278579,987462,168,5,0.05,574.5125),
(145278580,987462,174,5,0.05,313.2625),
(145278581,987462,158,5,0.05,242.2025),
(145278582,987463,165,7,0.07,289.695),
(145278583,987463,146,7,0.07,103.8345),
(145278584,987463,174,6,0.05,375.915),
(145278585,987463,159,6,0.05,290.643),
(145278586,987464,171,6,0.05,829.35),
(145278587,987464,155,6,0.05,284.943),
(145278588,987464,157,6,0.05,290.643),
(145278589,987465,156,8,0.07,225.06),
(145278590,987465,172,7,0.07,513.9645),
(145278591,987465,172,7,0.07,513.9645),
(145278592,987465,166,7,0.07,396.7845),
(145278593,987465,164,7,0.07,289.695),
(145278594,987466,171,8,0.07,1082.52),
(145278595,987466,160,8,0.07,639.468),
(145278596,987466,174,8,0.07,490.668),
(145278597,987469,170,9,0.08,1456.866),
(145278598,987469,160,9,0.08,711.666),
(145278599,987469,163,9,0.08,314.226),
(145278600,987469,154,9,0.08,231.426),
(145278601,987470,145,10,0,159.5),
(145278602,987470,153,9,0.08,231.426),
(145278603,987470,163,7,0.07,247.0545),
(145278604,987470,171,6,0.05,829.35),
(145278605,987471,162,6,0.05,216.315),
(145278606,987471,164,6,0.05,253.65),
(145278607,987471,145,6,0.05,90.915),
(145278608,987472,159,5,0.05,242.2025),
(145278609,987472,152,5,0.05,132.7625),
(145278610,987472,170,4,0,703.8),
(145278611,987472,169,4,0,462),
(145278612,987473,170,5,0.05,835.7625),
(145278613,987473,160,5,0.05,408.2625),
(145278614,987474,159,6,0.05,290.643),
(145278615,987474,153,6,0.05,159.315),
(145278616,987475,173,5,0.05,265.7625),
(145278617,987475,157,4,0,203.96),
(145278618,987475,162,4,0,151.8),
(145278619,987476,168,7,0.07,787.3845),
(145278620,987476,157,4,0,203.96),
(145278621,987476,164,4,0,178),
(145278622,987477,145,6,0.05,90.915),
(145278623,987477,174,3,0,197.85),
(145278624,987477,174,3,0,197.85),
(145278625,987477,161,1,0,37.95),
(145278626,987478,174,9,0.08,546.066),
(145278627,987478,174,7,0.07,429.3345),
(145278628,987478,154,5,0.05,132.7625),
(145278629,987478,150,4,0,150),
(145278630,987479,156,5,0.05,143.6875),
(145278631,987479,148,4,0,63.8),
(145278632,987479,158,2,0,101.98),
(145278633,987480,155,8,0.07,371.9256),
(145278634,987480,148,7,0.07,103.8345),
(145278635,987480,165,5,0.05,211.375),
(145278636,987481,174,9,0.08,546.066),
(145278637,987481,151,4,0,221),
(145278638,987481,161,3,0,113.85),
(145278639,987482,156,5,0.05,143.6875),
(145278640,987482,170,2,0,351.9),
(145278641,987482,161,1,0,37.95),
(145278642,987483,159,7,0.07,331.9449),
(145278643,987483,165,6,0.05,253.65),
(145278644,987483,169,4,0,462),
(145278645,987484,156,9,0.08,250.47),
(145278646,987484,169,7,0.07,751.905),
(145278647,987484,166,3,0,182.85),
(145278648,987484,173,3,0,167.85),
(145278649,987484,165,3,0,133.5),
(145278650,987485,152,7,0.07,181.9545),
(145278651,987485,152,7,0.07,181.9545),
(145278652,987485,145,7,0.07,103.8345),
(145278653,987485,159,4,0,203.96),
(145278654,987485,168,1,0,120.95),
(145278655,987486,155,6,0.05,284.943),
(145278656,987486,174,2,0,131.9),
(145278657,987486,171,1,0,145.5),
(145278658,987486,157,1,0,50.99),
(145278659,987487,149,7,0.07,103.8345),
(145278660,987487,174,5,0.05,313.2625),
(145278661,987487,154,4,0,111.8),
(145278662,987487,166,2,0,121.9),
(145278663,987488,173,8,0.07,416.268),
(145278664,987488,151,7,0.07,359.6775),
(145278665,987488,157,6,0.05,290.643),
(145278666,987489,165,9,0.08,368.46),
(145278667,987489,174,7,0.07,429.3345),
(145278668,987490,154,8,0.07,207.948),
(145278669,987490,151,5,0.05,262.4375),
(145278670,987491,174,6,0.05,375.915),
(145278671,987491,163,6,0.05,216.315),
(145278672,987491,157,5,0.05,242.2025),
(145278673,987491,159,3,0,152.97),
(145278674,987491,172,3,0,236.85),
(145278675,987493,174,8,0.07,490.668),
(145278676,987493,172,6,0.05,450.015),
(145278677,987493,146,4,0,63.8),
(145278678,987494,152,8,0.07,207.948),
(145278679,987494,173,4,0,223.8),
(145278680,987494,158,2,0,101.98),
(145278681,987494,169,2,0,231),
(145278682,987495,166,7,0.07,396.7845),
(145278683,987495,174,4,0,263.8),
(145278684,987495,158,1,0,50.99),
(145278685,987496,161,4,0,151.8),
(145278686,987496,154,4,0,111.8),
(145278687,987496,171,3,0,436.5),
(145278688,987496,167,3,0,182.85),
(145278689,987496,167,3,0,182.85),
(145278690,987496,153,2,0,55.9);


